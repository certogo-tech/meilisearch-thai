# Thai Search Proxy Environment Configuration for NPM Deployment
# Copy this file to .env and customize for your deployment

# === External MeiliSearch Configuration ===
# Point to your existing MeiliSearch instance
MEILISEARCH_HOST=http://172.17.0.1:7700
MEILISEARCH_API_KEY=your-meilisearch-api-key-here
MEILISEARCH_INDEX=documents
MEILISEARCH_SSL_VERIFY=false
MEILISEARCH_TIMEOUT_MS=10000
MEILISEARCH_MAX_RETRIES=3

# === Service Configuration ===
# Port that NPM will proxy to (default: 8000)
THAI_TOKENIZER_PORT=8000
SERVICE_HOST=0.0.0.0
LOG_LEVEL=INFO
DEBUG=false
VERSION=1.0.0
ENVIRONMENT=production

# === Tokenizer Configuration ===
TOKENIZER_ENGINE=pythainlp
ENABLE_MIXED_LANGUAGE=true

# === Search Proxy Configuration ===
# Primary tokenization engine for search
SEARCH_PROXY_PRIMARY_ENGINE=newmm

# Fallback engines (comma-separated)
SEARCH_PROXY_FALLBACK_ENGINES=attacut,deepcut

# Maximum concurrent searches
SEARCH_PROXY_MAX_CONCURRENT=10

# Search timeout in milliseconds
SEARCH_PROXY_TIMEOUT_MS=5000

# Ranking algorithm (weighted_score or optimized_score)
SEARCH_PROXY_RANKING_ALGORITHM=optimized_score

# Minimum score threshold (0.0 to disable filtering)
SEARCH_PROXY_MIN_SCORE_THRESHOLD=0.0

# Enable caching for better performance
SEARCH_PROXY_CACHE=true

# === Performance Settings ===
BATCH_SIZE=25
MAX_WORKERS=4
REQUEST_TIMEOUT=30
WORKER_PROCESSES=4
TOKENIZER_CACHE_SIZE=2000

# === Resource Limits ===
CPU_LIMIT=3.0
MEMORY_LIMIT=1.5G
CPU_RESERVATION=1.0
MEMORY_RESERVATION=512M

# === Security (NPM handles HTTPS) ===
CORS_ORIGINS=*
ALLOWED_HOSTS=*

# API Key Authentication
# Set to true to require API key for all requests (recommended for production)
API_KEY_REQUIRED=false

# API key for authentication (required if API_KEY_REQUIRED=true)
# Generate secure key with: openssl rand -hex 32
# SEARCH_PROXY_API_KEY=your-secure-api-key-here

# === Feature Flags ===
ENABLE_EXPERIMENTAL=false
ENABLE_AB_TESTING=false
DETAILED_LOGGING=false

# === Monitoring (Optional) ===
# Uncomment to enable Prometheus monitoring
# COMPOSE_PROFILES=monitoring
# PROMETHEUS_PORT=9090

# === Custom Dictionary ===
CUSTOM_DICTIONARY_PATH=/app/data/dictionaries/thai_compounds.json

# === Docker Compose Settings ===
COMPOSE_PROJECT_NAME=thai_search_proxy_npm